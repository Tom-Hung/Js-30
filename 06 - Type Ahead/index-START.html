<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Type Ahead ğŸ‘€</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <form class="search-form">
      <input type="text" class="search" placeholder="City or State" />
      <ul class="suggestions"></ul>
    </form>
    <script>
      const endpoint = "https://gist.githubusercontent.com/Miserlou/c5cd8364bf9b2420bb29/raw/2bf258763cdddd704f8ffd3ea9a3e81d25e2c6f6/cities.json";

      // My way
      // ----------------------------------------------------------------------------------------
      // function showData() {
      //   console.log(this.value);
      //   console.log(document.querySelector(".suggestions").querySelectorAll("li"));
      //   const old_list = document.querySelector(".suggestions").querySelectorAll("li");

      //   old_list.forEach((li) => {
      //     li.remove();
      //   });

      //   fetch(endpoint, { method: "GET" })
      //     .then((res) => {
      //       // console.log(res.json());
      //       return res.json();
      //     })
      //     .then((datas) => {
      //       console.log(datas);
      //       const filter_data = datas.filter((data) => {
      //         // console.log(data.city);
      //         if (data.city.toLowerCase().includes(this.value.toLowerCase() === "" ? false : this.value.toLowerCase())) {
      //           return data;
      //         }
      //       });

      //       filter_data.forEach((data) => {
      //         console.log(data.city);
      //         document.querySelector(".suggestions").insertAdjacentHTML("beforeend", `<li>${data.city} ${data.population}</li>`);
      //       });
      //     });
      // }

      // const search = document.querySelector(".search");
      // // console.log(search);
      // search.addEventListener("input", showData);
      // ----------------------------------------------------------------------------------------
      // æª¢è¨
      // æˆ‘çš„å¯«æ³•æ˜¯æ¯æ¬¡ input æ™‚éƒ½å» fetch ä¸€æ¬¡ï¼Œéå¸¸çš„è€—è³‡æºèˆ‡æ™‚é–“ï¼Œæ‰€ä»¥å¯¦éš›ä¸Šæˆ‘åªéœ€è¦å»ºç«‹ä¸€å€‹è®Šæ•¸ï¼Œå°‡
      // å–å¾—çš„è³‡æ–™å­˜å…¥å°±å¥½ï¼Œç•¶ç„¶æˆ‘ç›´æ¥ console çš„è©±ï¼Œé€™è®Šæ•¸æœƒæ˜¯ç©ºçš„ï¼Œå› ç‚ºåƒ fetch é€™ç¨®éåŒæ­¥äº‹ä»¶å±¬æ–¼
      // eventque æœƒç­‰åˆ° execution context åŸ·è¡Œå®Œå¾Œæ‰è¢«åŸ·è¡Œï¼Œè€Œ execution context æ™‚å°±åˆ—å°è©²è®Šæ•¸ï¼Œè‡ª
      // ç„¶æœƒæ˜¯ undefinedï¼Œä¸éï¼Œé€™å°å¾ŒçºŒçš„æ‡‰ç”¨ä¹Ÿä¸å½±éŸ¿ï¼Œå› ç‚ºæˆ‘å€‘çš„æŸ¥è©¢ä¹Ÿæ˜¯ä¸€å€‹ eventque ï¼Œåœ¨é‚£æ™‚æˆ‘å€‘çš„
      // è®Šæ•¸è£¡å·²ç¶“è£æœ‰è³‡æ–™äº†ã€‚

      // é—œæ–¼æ¨¡çµ„åŒ–çš„æ¦‚å¿µéå¸¸é‡è¦ï¼ŒæŠŠèƒ½æ‹†åˆ†çš„åŠŸèƒ½ç¨ç«‹ç‚ºä¸€å€‹ function çœŸçš„ç°¡æ½”è¨±å¤š

      // ----------------------------------------------------------------------------------------
      // Autohor way
      // ----------------------------------------------------------------------------------------
      // const cities = [];
      // const Searchinput = document.querySelector(".search");
      // const Suggestionslist = document.querySelector(".suggestions");

      // fetch(endpoint)
      //   .then((res) => {
      //     console.log(res);
      //     return res.json();
      //   })
      //   .then((data) => {
      //     console.log(data);
      //     // spread èªæ³•ï¼Œ... å°±æ˜¯è¤‡è£½ä¸€ä»½æŸç‰©ä»¶çš„å…§å®¹çš„
      //     cities.push(...data);
      //   });

      // function findMatch(wordToMatch, cities) {
      //   return cities.filter((place) => {
      //     //æ­£è¦è¡¨é”æ˜¯ç‰©ä»¶ï¼Œç¬¬ä¸€å€‹åƒæ•¸ç‚ºå®šç¾©ä¾†æ¯”å°çš„æ¨¡å‹ã€ç¬¬äºŒå€‹æ˜¯æ¯”å°è¦å‰‡ï¼Œg:æ¯”å°å­—ä¸²æ‰€æœ‰ä½ç½®  i:ä¸å€åˆ†å¤§å°å¯«
      //     const regex = new RegExp(wordToMatch, "gi");
      //     return place.city.match(regex) || place.state.match(regex);
      //   });
      // }

      // function displayMatch() {
      //   const matchArray = findMatch(this.value, cities);
      //   const html = matchArray
      //     .map((place) => {
      //       const regex = new RegExp(this.value, "gi");
      //       const cityName = place.city.replace(regex, `<span class="hl">${this.value}</span>`);
      //       const stateName = place.city.replace(regex, `<span class="hl">${this.value}</span>`);

      //       return `<li>
      //         <span>${cityName} ${stateName}</span>
      //         <span>${place.population}</span>
      //       </li>`;
      //     })
      //     .join("");
      //   console.log(html);
      //   Suggestionslist.innerHTML = html;
      // }

      // Searchinput.addEventListener("input", displayMatch);

      // ----------------------------------------------------------------------------------------
      // æª¢è¨
      // 1. fetch ?
      //      console.log(fetch(endpoint));
      //      fetch æœƒå›å‚³ä¸€å€‹ Promise ç‰©ä»¶ï¼Œç‰©ä»¶æœ‰å±¬æ€§ã€æ–¹æ³•ï¼ŒPromise ç‰©ä»¶æœ‰å±¬æ€§ï¼Œä¾‹å¦‚ status å‘Šè¨´æˆ‘å€‘é€£æ¥çš„ç‹€æ…‹ï¼Œ
      //      æœ‰ then() catch() æ–¹æ³•ï¼Œå¯ä»¥å°å–å¾—åˆ°çš„çµæœé€²è¡Œå¾ŒçºŒæ“ä½œã€‚
      //      ç¬¬ä¸€å€‹ .then() æˆ‘å€‘æœƒå°é€£ç·šçš„çµæœé€²è¡Œæ“ä½œï¼Œä¾‹å¦‚æˆåŠŸå°±è½‰ json() æ ¼å¼ï¼Œå¤±æ•—å°± throw error
      //      æ ¹æ“šç¬¬ä¸€å€‹ then å›å‚³çš„çµæœï¼Œæˆ‘å€‘å¯ä»¥ç”±ä¸‹ä¸€å€‹ then() åšæ¥çºŒï¼Œæˆ–è€…å¤±æ•—æ™‚ç”± catch æ¥çºŒ

      // 2. æ­£è¦è¡¨é”å¼ ?
      //      å¯ä»¥ç”¨ä¾†æœå°‹ã€æª¢æŸ¥ã€æ›¿æ›å­—ä¸²ï¼ŒåŸç†å°±æ˜¯æˆ‘å®£å‘Šä¸€å€‹ regular expression ç‰©ä»¶ï¼Œç‰©ä»¶è£¡é¢å®šç¾©æˆ‘é è¨­çš„æ¨¡å‹ï¼Œä¹‹å¾Œæˆ‘å°‡
      //      è¦æˆ‘çš„å­—ä¸²èˆ‡é€™å€‹æ¨¡å‹åšæ¯”è¼ƒï¼Œä¾†é€²è¡Œå¾ŒçºŒæ“ä½œæ¯”å°(match)ã€æ›¿æ›(replace) ... ( äº”å€ç´…å¯¶çŸ³æœ‰è©³ç´°ä»‹ç´¹ )

      // 3. Array.forEach() æœƒå›å‚³ undefined å–”ï¼Œæ‰€ä»¥å¸Œæœ›æœ‰å›å‚³è·çš„è©±é‚„æ˜¯ç”¨ map() å§ï¼Œå¸Œæœ›å›å‚³çš„ä¸æ˜¯é™£åˆ—å°±åœ¨è½‰æ›å°±å¥½ï¼Œä¾‹å¦‚
      //     join() å¯ä»¥å°‡é™£åˆ—è½‰ç‚ºå­—ä¸²

      // 4. .innerHTML = HTML å¯ä»¥æ’å…¥ HTML TAG ä¹Ÿå¯ä»¥æ˜¯ä¸€å€‹æ®µè½ï¼ŒinsertAdjacentHTML()é€™å€‹æ–°æ–¹æ³•ä¼¼ä¹å°æ–¼æ’å…¥æœ‰æ›´å¥½çš„æ•ˆèƒ½
    </script>
  </body>
</html>
